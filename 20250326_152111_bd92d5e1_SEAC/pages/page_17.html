<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Validação: Serviço de Informações ao Cidadão – SIC</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { padding-top: 20px; padding-bottom: 50px; }
        .validation-card { margin-bottom: 20px; }
        .error-details { 
            background-color: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            margin-top: 10px;
            white-space: pre-wrap;
        }
        .navbar { position: fixed; bottom: 0; width: 100%; z-index: 100; }
        .approval-btn { margin-top: 15px; }
        .nav-bottom { 
            position: fixed;
            bottom: 0;
            width: 100%;
            background-color: #f8f9fa;
            border-top: 1px solid #ddd;
            padding: 10px 0;
            z-index: 1000;
        }
        .page-container { margin-bottom: 60px; }
    </style>
</head>
<body>
    <div class="container page-container">

        <h1 class="mb-4">Detalhes da Validação</h1>
        <div class="card validation-card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="mb-0">Serviço de Informações ao Cidadão – SIC</h5>
                <span id="pageStatusBadge" class="badge bg-danger">Inválida</span>
            </div>
            <div class="card-body">
                <div class="row mb-3">
                    <div class="col-md-6">
                        <strong>URL Original:</strong> 
                        <a href="https://www.seac.df.gov.br/servico-de-informacoes-ao-cidadao-sic" target="_blank" class="btn btn-sm btn-outline-primary">https://www.seac.df.gov.br/servico-de-informacoes-ao-cidadao-sic</a>
                    </div>
                    <div class="col-md-6">
                        <strong>URL Migrada:</strong> 
                        <a href="https://seac-hml.df.gov.br:8443/servico-de-informacoes-ao-cidadao-sic" target="_blank" class="btn btn-sm btn-outline-primary">https://seac-hml.df.gov.br:8443/servico-de-informacoes-ao-cidadao-sic</a>
                    </div>
                </div>
                
                <div class="mb-3">
                    <strong>Timestamp:</strong> 2025-03-25 20:01:41
                </div>
                
                <div class="mb-3">
                    <strong>Scores de Similaridade:</strong>
                    <ul class="list-group">
                        <li class="list-group-item">Conteúdo: 40%</li>
                        <li class="list-group-item">Estrutura: 43%</li>
                    </ul>
                </div>
                
                <h5 class="mt-4 mb-3">Erros Encontrados:</h5>
                <ul class="list-group">
<li class="list-group-item text-danger">Content Mismatch: Conteúdo principal não corresponde ao original (Similaridade: 40.00%):
Removido: '14/04/20 às 9h52 - atualizado em 18/11/24 às 11h01 serviço de informações ao cidadão – sic'
Removido: 'canais de atendimento via internet: acesse o sistema e-sic e siga o passo a passo. os temas e tipos de informação constam no artigo 7º da lei distrital de acesso à informação nº 4.990/2012. presencial: o atendimento presencial é oferecido em todas as ouvidorias. clique aqui e consulte o endereço da ouvidoria do seu interesse. passo a passo 1º passo – registro do pedido de informação. 2º passo – órgão responsável analisa a disponibilidade da informação. 3º passo – envio da resposta ao cidadão. requisitos e documentos o pedido de informação deverá conter: nome do requerente. apresentação de documento de identificação válido (carteira de identidade, cadastro de pessoas físicas – cpf, cadastro nacional de pessoas jurídicas – cnpj, título de eleitor, passaporte, carteira de trabalho, carteira funcional, carteira de habilitação (modelo novo) e certificado de reservista). especificação, de forma clara e precisa, da informação requerida. endereço físico ou eletrônico do requerente, para recebimento de comunicações ou da informação requerida. importante não será atendido pedido de informação genérico, desproporcional, desarrazoado, que exija trabalho adicional de análise, interpretação, consolidação de dados e informações, serviço de produção ou tratamento de dados que não seja de competência do órgão ou entidade. prazo o órgão terá até 20 dias, a contar da data de registro, para responder o pedido de informação prorrogável por mais 10 dias mediante justificativa. caso o cidadão não fique satisfeito com a resposta ele pode recorrer a: 1ª instância: autoridade hierarquicamente superior àquela que negou a informação. 2ª instância: autoridade máxima do órgão. 3ª instância: controladoria-geral do distrito federal. os prazos para recurso nas instâncias acima são de 10 dias a partir da ciência da resposta por parte do cidadão. a resposta da autoridade à manifestação é de até 5 dias. na 3ª instância o prazo pode ser estendido enquanto estiver em análise (art.24, § 1º, do decreto nº 34.276/2013). se o órgão não responder ao pedido no prazo máximo de 30 dias, é possível fazer uma reclamação à autoridade de monitoramento do órgão. a reclamação deve ser registrada em até 10 dias depois do vencimento do prazo por parte da pasta que terá até 5 dias para se manifestar. caso não haja resposta, o solicitante deve procurar a controladoria-geral do df. o recurso também deve ser apresentado em até 10 dias. custos o serviço é gratuito. serão cobradas apenas as reproduções de: – cópias de documentos; – gravação de mídias; – envios postais; clique aqui para ver as taxas para reprodução de material, de acordo com a portaria nº 116, de 11 de junho de 2008. informações adicionais 1 – existem alguns casos em que as informações podem ser negadas. são elas: – quando o documento se referir à investigação sigilosa. – documentos classificados como reservado, secreto ou ultrassecreto. – quando envolver dados pessoais de terceiros, que não seja o solicitante. 2 – caso o cidadão não fique satisfeito com a resposta ele pode recorrer: 1ª instância: autoridade hierarquicamente superior àquela que negou a informação. 2ª instância: autoridade máxima do órgão. 3ª instância: controladoria-geral do distrito federal. os prazos para recurso nas instâncias acima são de 10 dias a partir da ciência da resposta por parte do cidadão. a resposta a manifestação é de até 5 dias. 3 – se o órgão não responder ao pedido no prazo máximo de 30 dias, é possível fazer uma reclamação à autoridade de monitoramento do órgão. a reclamação deve ser registrada em até 10 dias depois do vencimento do prazo por parte da pasta que terá até 5 dias para se manifestar. caso não haja resposta, o solicitante deve procurar a controladoria-geral do df. o recurso também deve ser apresentado em até 10 dias.'</li><li class="list-group-item text-danger">HTML Structure Mismatch: Estrutura HTML divergente (Similaridade: 43.00% < 80.0%)</li>
                </ul>
                
                <div class="approval-btn">
                    <button id="approveBtn" class="btn btn-success" onclick="approvePage('page_17')">
                        Aprovar Página
                    </button>
                    <button id="rejectBtn" class="btn btn-danger ms-2" onclick="rejectPage('page_17')">
                        Rejeitar Página
                    </button>
                    <div id="approvalStatus" class="mt-2"></div>
                </div>
            </div>
        </div>
        
        <div class="mt-4">
            <a href="../index.html" class="btn btn-primary">Voltar para o Dashboard</a>
        </div>
    </div>
    
    <div class="nav-bottom">
        <div class="container">
            <div class="d-flex justify-content-between">
                <span class="text-muted">Validação de migração de páginas</span>
                <span class="text-muted">Gerado em: 26/03/2025 15:21:11</span>
            </div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Variáveis de configuração
        const reportId = 'bd92d5e1';
        const pageId = 'page_17';
        
        // Função para buscar aprovações da API
        async function fetchApprovals() {
            try {
                const response = await fetch(`/api/approvals/${reportId}/${pageId}`);
                if (!response.ok) {
                    throw new Error('Erro ao buscar aprovações');
                }
                return await response.json();
            } catch (error) {
                console.error('Erro:', error);
                return {};
            }
        }
        
        // Função para enviar aprovação para a API
        async function sendApproval(status) {
            try {
                const response = await fetch(`/api/approvals/${reportId}/${pageId}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        status: status,
                        user: 'validador'
                    }),
                });
                
                if (!response.ok) {
                    throw new Error('Erro ao enviar aprovação');
                }
                
                return await response.json();
            } catch (error) {
                console.error('Erro:', error);
                alert('Erro ao enviar aprovação. Tente novamente.');
                return null;
            }
        }
        
        // Gerenciamento de aprovação usando a API
        async function approvePage() {
            const result = await sendApproval('approved');
            if (result) {
                updateUI();
                alert("Página aprovada! Esta página aparecerá na seção de páginas aprovadas quando você voltar ao dashboard.");
            }
        }
        
        async function rejectPage() {
            const result = await sendApproval('rejected');
            if (result) {
                updateUI();
            }
        }
        
        async function updateUI() {
            const approval = await fetchApprovals();
            const status = document.getElementById('approvalStatus');
            const approveBtn = document.getElementById('approveBtn');
            const rejectBtn = document.getElementById('rejectBtn');
            const statusBadge = document.getElementById('pageStatusBadge');
            
            if (approval && approval.status) {
                if (approval.status === 'approved') {
                    status.innerHTML = '<div class="alert alert-success">Página aprovada!</div>';
                    statusBadge.textContent = 'Aprovada';
                    statusBadge.classList.remove('bg-danger');
                    statusBadge.classList.add('bg-success');
                    approveBtn.disabled = true;
                    rejectBtn.disabled = false;
                } else {
                    status.innerHTML = '<div class="alert alert-danger">Página rejeitada!</div>';
                    statusBadge.textContent = 'Rejeitada';
                    statusBadge.classList.remove('bg-success');
                    statusBadge.classList.add('bg-danger');
                    approveBtn.disabled = false;
                    rejectBtn.disabled = true;
                }
            } else {
                status.innerHTML = '';
                statusBadge.textContent = 'Inválida';
                statusBadge.classList.remove('bg-success');
                statusBadge.classList.add('bg-danger');
                approveBtn.disabled = false;
                rejectBtn.disabled = false;
            }
        }
        
        // Inicializar
        document.addEventListener('DOMContentLoaded', updateUI);
    </script>
</body>
</html>